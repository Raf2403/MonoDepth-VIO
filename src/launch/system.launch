<launch>
    <!-- 1. КАМЕРА REALSENSE D435 -->
    <!-- Включаем камеру, если вы снимаете в реальном времени -->
    <include file="$(find realsense2_camera)/launch/rs_camera.launch">
        <arg name="enable_gyro" value="false"/>
        <arg name="enable_accel" value="false"/>
        <arg name="align_depth" value="true"/>
        <arg name="enable_sync" value="true"/>
        <arg name="color_width" value="640"/>
        <arg name="color_height" value="480"/>
        <arg name="color_fps" value="30"/>
    </include>

    <!-- 2. IPHONE IMU (CSV PLAYER) -->
    <!-- Запускаем скрипт, который читает CSV и шлет данные как топик -->
    <node pkg="MonoDepth-VIO" type="csv_imu_publisher.py" name="csv_imu_player" output="screen">
        <!-- Укажите путь к вашему CSV файлу внутри Docker -->
        <param name="csv_path" value="$(find MonoDepth-VIO)/data/iphone_imu.csv"/>
        <param name="topic_name" value="/iphone/imu"/>
        <param name="frequency" value="500"/> <!-- Частота данных в Гц -->
    </node>

    <!-- 3. OPENVINS -->
    <node name="ov_msckf" pkg="ov_msckf" type="run_subscribe_msckf" output="screen">
        <param name="config_path" value="$(find MonoDepth-VIO)/config/d435_iphone.yaml"/>
    </node>

    <!-- 4. RVIZ -->
    <node type="rviz" name="rviz" pkg="rviz" args="-d $(find ov_msckf)/launch/display.rviz" />
</launch>
